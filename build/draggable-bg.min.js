/*! 
 * draggable-bg v1.0.0
 * https://github.com/chieffancypants/draggable-bg
 * Copyright (c) 2015 Wes Cruver
 * License: MIT
 */
!function(){"use strict";angular.module("chieffancypants.draggableBg",[]).directive("draggableBg",function(a){return{scope:{imgSrc:"=draggableBg",displayPosX:"=draggableBgX",displayPosY:"=draggableBgY"},link:function(b,c){function d(){i=(c.css("background-image").match(/^url\(['"]?(.*?)['"]?\)$/i)||[])[1],c.css("background-image"),o.src=i}function e(a,c){var d=c[0];l=b.displayPosX||Math.round((d.clientWidth-n.width)/2),m=b.displayPosY||Math.round((d.clientHeight-n.height)/2),c.css("background-position",l+"px "+m+"px")}function f(a,b,c,d){if(3===arguments.length||d){if(a>c)return Math.floor(a);if(c>b)return Math.floor(b)}return c}function g(a){m=a.pageY-k,m=f(c[0].clientHeight-n.height,0,m,!0),l=a.pageX-j,l=f(c[0].clientWidth-n.width,0,l,!0),c.css({backgroundPosition:l+"px "+m+"px"}),b.displayPosX=l,b.displayPosY=m,console.log(b.displayPosY)}function h(){a.off("mousemove",g),a.off("mouseup",h),b.$digest()}var i,j=0,k=0,l=0,m=0,n={width:0,height:0},o=new Image;c.css("background-image","url("+b.imgSrc+")"),c.on("mousedown",function(b){b.preventDefault(),j=b.pageX-l,k=b.pageY-m,a.on("mousemove",g),a.on("mouseup",h)}),b.$evalAsync(function(){d()}),o.onload=function(){var a=c[0],d=a.ownerDocument.defaultView.getComputedStyle(a,null)["background-size"],f=a.clientWidth,g=a.clientHeight;if("cover"===d){var h=f/g,i=o.width/o.height,j=1;j=i>=h?g/o.height:f/o.width,n.width=o.width*j,n.height=o.height*j}else n.width=o.width,n.height=o.height;e(b.moment,c)}}}})}();